/*! @license pzpr.js v290f439d (c) 2009-2021 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */

!function(a,b){"object"==typeof module&&module.exports?module.exports=[a,b]:pzpr.classmgr.makeCustom(a,b)}(["tents"],{MouseEvent:{use:!0,inputModes:{edit:["number","mark-tree","clear"],play:[]},mouseinput_other:function(){switch(this.inputMode){case"mark-tree":this.inputFixedNumber(1);break;case"mark-tent":this.inputFixedNumber(2)}},mouseinput_number:function(){this.mousestart&&(this.inputqnum_excell(),this.notInputted&&this.inputqnum())},mouseinput_auto:function(){this.puzzle.playmode?this.inputLine():this.puzzle.editmode&&this.mouseend&&this.notInputted()&&(this.inputqnum_excell(),this.notInputted&&this.inputqnum())},inputcell_tents:function(a,b){if(!a.isnull&&a!==this.mouseCell&&-1===a.qnum){if(null===this.inputData){var c=2===a.anum?1:1===a.qsub?2:0;if(b)this.inputData=c!==b?b:0;else if(1===this.puzzle.getConfig("use")){var d="left"===this.btn?1:2;this.inputData=c!==d?d:0}else{var d=c+("left"===this.btn?1:-1);this.inputData=(d+3)%3}}1===this.inputData&&this.placedTent||2===this.inputData&&this.placedTent&&2===a.anum||(a.setAnum(1===this.inputData?2:-1),2===this.inputData?a.setQsub(1):1===a.qsub&&a.setQsub(0),a.removeAuxLines(),a.draw(),this.mouseCell=a,this.placedTent=!0)}},inputqnum_excell:function(){var a=this.getcell_excell();a.isnull||"excell"!==a.group||(a!==this.cursor.getex()?this.setcursor(a):this.inputqnum_main(a))},inputDot:function(){this.inputcell_tents(this.getcell(),2)}},KeyEvent:{enablemake:!0,keyinput:function(a){this.key_inputexcell(a),this.key_inputqnum(a)},key_inputexcell:function(a){var b=this.cursor.getex(),c=b.qnum,d=b.getmaxnum();if("0"<=a&&a<="9"){var e=+a;c<=0||this.prev!==b?e<=d&&b.setQnum(e):10*c+e<=d?b.setQnum(10*c+e):e<=d&&b.setQnum(e)}else{if(" "!==a&&"-"!==a)return;b.setQnum(-1)}this.prev=b,this.cursor.draw()}},TargetCursor:{initCursor:function(){this.init(-1,-1)}},ExCell:{disInputHatena:!0,maxnum:function(){var a=this.bx,b=this.by;return-1===a&&-1===b?0:-1===b?this.board.rows:this.board.cols},minnum:0},Border:{prehook:{qsub:function(a){return!!a&&(1!==this.sidecell[0].getNum()&&1!==this.sidecell[1].getNum())}}},Cell:{numberAsObject:!0,disInputHatena:!0,maxnum:function(){return this.puzzle.editmode?1:3},posthook:{qnum:function(a){a>=0&&this.setQsub(0)}},removeAuxLines:function(){var a=2===this.getNum()?1:1===this.getNum()?2:null;for(var b in this.adjacent){var c=this.adjacent[b];if(c&&!c.isnull&&c.getNum()!==a){var d=this.getnb(c);d.isnull||1!==d.qsub||d.setQsub(0)}}}},Board:{hasborder:1,hasexcell:1,cols:8,rows:8,addExtraInfo:function(){this.campgraph=this.addInfoList(this.klass.AreaCampGraph)}},BoardExec:{adjustBoardData:function(a,b){this.adjustExCellTopLeft_1(a,b)},adjustBoardData2:function(a,b){this.adjustExCellTopLeft_2(a,b)}},"AreaCampGraph:AreaNumberGraph":{enabled:!0,makeClist:!0,setComponentRefs:function(a,b){a.camp=b},getObjNodeList:function(a){return a.campnodes},resetObjNodeList:function(a){a.campnodes=[]},isnodevalid:function(a){return 1===a.getNum()||2===a.getNum()},isedgevalidbynodeobj:function(a,b){return 1===a.getNum()&&2===b.getNum()||2===a.getNum()&&1===b.getNum()},setExtraData:function(a){this.common.setExtraData.call(this,a),a.counts={tents:0,trees:0};for(var b=0;b<a.nodes.length;b++){switch(a.nodes[b].obj.getNum()){case 1:a.counts.trees++;break;case 2:a.counts.tents++}}}},Graphic:{enablebcolor:!0,bgcellcolor_func:"error1",qanscolor:"rgb(0, 127, 0)",linecolor:"#7c4615",paint:function(){this.drawBGCells(),this.drawDotCells(),this.drawGrid(),this.drawBorderQsubs(),this.drawPekes(),this.drawTents(),this.drawTrees(),this.drawNumbersExCell(),this.drawChassis(),this.drawLines(),this.drawTarget()},drawBorderQsubs:function(){for(var a=this.vinc("border_qsub","crispEdges",!0),b=this.range.borders,c=0;c<b.length;c++){var d=b[c];if(a.vid="b_qsub1_"+d.id,1===d.qsub){var e=d.bx*this.bw,f=d.by*this.bh;a.fillStyle=d.trial?this.trialcolor:this.pekecolor,d.isHorz()?a.fillRectCenter(e,f,1,this.bh):a.fillRectCenter(e,f,this.bw,1)}else a.vhide()}},drawTents:function(){for(var a=this.vinc("cell_tent","auto"),b=.25*this.cw,c=.125*this.cw,d=.05*this.cw,e=.1*this.cw,f=.325*this.cw,g=this.range.cells,h=0;h<g.length;h++){var i=g[h],j=i.bx*this.bw,k=(i.by+.15)*this.bh,l=i.getNum();switch(-1!==l||i.isDot()||(l=i.qinfo),l){case 2:a.vid="c_tentouter_"+i.id;var m=this.getAnsNumberColor(i);-1===i.getNum()&&this.board.trialstage>0&&(m=this.trialcolor),a.fillStyle=m,a.beginPath(),a.setOffsetLinePath(j,k,0,-b,-b,b,b,b,!0),a.fill(),a.vid="c_tentinner_"+i.id,a.fillStyle="white",a.beginPath(),a.setOffsetLinePath(j,k,0,0,-c,b,c,b,!0),a.fill(),a.vid="c_tentline_"+i.id,a.lineWidth=Math.max(this.cw/32,2),a.strokeStyle=m,a.beginPath(),a.moveTo(j-f,k+b),a.lineTo(j+f,k+b),a.moveTo(j-b,k+b),a.lineTo(j+d,k-(b+e)),a.moveTo(j+b,k+b),a.lineTo(j-d,k-(b+e)),a.closePath(),a.stroke();break;default:a.vid="c_tentouter_"+i.id,a.vhide(),a.vid="c_tentinner_"+i.id,a.vhide(),a.vid="c_tentline_"+i.id,a.vhide()}}},drawTrees:function(){for(var a=this.vinc("cell_tree","auto"),b=.275*this.cw,c=.08*this.cw,d=.35*this.cw,e=this.range.cells,f=0;f<e.length;f++){var g=e[f],h=g.bx*this.bw,i=g.by*this.bh;switch(g.getNum()){case 1:a.lineWidth=Math.max(this.cw/32,2),a.vid="c_treeroot_"+g.id,a.fillStyle="black",a.fillRect(h-c,i,2*c,d),a.vid="c_treetop_"+g.id,a.strokeStyle="black",a.fillStyle="rgb(212,251,121)",a.shapeCircle(h,i-.15*this.bh,b);break;default:a.vid="c_treeroot_"+g.id,a.vhide(),a.vid="c_treetop_"+g.id,a.vhide()}}}},Encode:{decodePzpr:function(a){this.decodeNumber16ExCell(),this.decode1Cell(1)},encodePzpr:function(a){this.encodeNumber16ExCell(),this.encode1Cell(1)}},FileIO:{decodeData:function(){this.decodeCellExCell(function(a,b){"."!==b&&("excell"!==a.group||a.isnull?"cell"===a.group&&(+b>0?a.qnum=+b:"A"===b?a.anum=2:"-"===b&&(a.qsub=1)):a.qnum=+b)}),this.decodeBorderAns()},encodeData:function(){this.encodeCellExCell(function(a){if("excell"===a.group&&!a.isnull&&-1!==a.qnum)return a.qnum+" ";if("cell"===a.group){if(-1!==a.qnum)return a.qnum+" ";if(2===a.anum)return"A ";if(1===a.qsub)return"- "}return". "}),this.encodeBorderAns()}},AnsCheck:{checklist:["checkAroundTents","checkTreeNone","checkCampsGt","checkTentNone","checkCampsLt","checkTentCount+"],checkAroundTents:function(){for(var a=this.board,b=0;b<a.cell.length;b++){var c=a.cell[b];if(2===c.getNum()){var d=null,e=new this.klass.CellList;if(e.add(c),d=c.relcell(2,0),2===d.getNum()&&e.add(d),d=c.relcell(0,2),2===d.getNum()&&e.add(d),d=c.relcell(-2,2),2===d.getNum()&&e.add(d),d=c.relcell(2,2),2===d.getNum()&&e.add(d),!(e.length<=1)){if(this.failcode.add("tentAround"),this.checkOnly)break;e.seterr(1)}}}},checkTentNone:function(){this.checkCamps_inner(function(a){return 0===a.counts.tents},"nmTentNone")},checkTreeNone:function(){this.checkCamps_inner(function(a){return 0===a.counts.trees},"nmTreeNone")},checkCampsLt:function(){this.checkCamps_inner(function(a){return a.counts.tents>0&&a.counts.tents<a.counts.trees},"nmTentLt")},checkCampsGt:function(){this.checkCamps_inner(function(a){return a.counts.trees>0&&a.counts.tents>a.counts.trees},"nmTentGt")},checkCamps_inner:function(a,b){for(var c=this.board.campgraph.components,d=0;d<c.length;d++){var e=c[d];if(e&&a(e)){if(this.failcode.add(b),this.checkOnly)break;e.clist.seterr(1)}}},checkTentCount:function(){this.checkRowsCols(this.isExCellCount,"exTentNe")},isExCellCount:function(a){var b=a.getRectSize(),c=this.board,d=a.filter(function(a){return 2===a.getNum()}).length,e=!0;if(b.x1===b.x2){var f=c.getex(b.x1,-1);-1!==f.qnum&&f.qnum!==d&&(f.seterr(1),e=!1)}if(b.y1===b.y2){var f=c.getex(-1,b.y1);-1!==f.qnum&&f.qnum!==d&&(f.seterr(1),e=!1)}return e||a.seterr(1),e}},FailCode:{nmTentNone:["テントが隣り合っていない木があります。","A tree has no tent."],nmTreeNone:["木に接していないテントがあります。","A tent is not next to a tree."],nmTentLt:["木の数よりもテントの数が少ない部分があります。","There aren't enough tents around a tree."],nmTentGt:["木の数よりもテントの数が多い部分があります。","There are too many tents around a tree."],tentAround:["テント同士が接しています。","Some tents touch."],exTentNe:["行または列にあるテントの数が正しくありません。","The number of tents in the row or column is not correct."]}});
//# sourceMappingURL=tents.js.map